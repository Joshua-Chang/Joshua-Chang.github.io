<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://Joshua-Chang.github.io</id>
    <title>Joshua-Chang`Blog</title>
    <updated>2021-02-28T16:32:45.773Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://Joshua-Chang.github.io"/>
    <link rel="self" href="https://Joshua-Chang.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://Joshua-Chang.github.io/images/avatar.png</logo>
    <icon>https://Joshua-Chang.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, Joshua-Chang`Blog</rights>
    <entry>
        <title type="html"><![CDATA[JetPack Compose 01]]></title>
        <id>https://Joshua-Chang.github.io/post/jetpack-compose-01/</id>
        <link href="https://Joshua-Chang.github.io/post/jetpack-compose-01/">
        </link>
        <updated>2021-02-28T08:27:34.000Z</updated>
        <content type="html"><![CDATA[<p>@Composable/<em>æ ‡è®°ç»„åˆå‡½æ•°ï¼Œå¯æä¾›å…¶ä»–å‡½æ•°ä½¿ç”¨</em>/</p>
<pre><code class="language-kotlin">@Composable
fun MyApp(content: @Composable () -&gt; Unit) {/*ä¹Ÿå¯ä»¥ ç»„åˆå‡½æ•°ä¸ºå‚æ•°*/
MyTheme{
        Surface(color = Color.Yellow) {
            content()
        }
    }
}
</code></pre>
<p>@Preview/<em>åªèƒ½ç”¨ä¸æ— å‚å‡½æ•°</em>/</p>
<h2 id="foundationåŒ…">foundationåŒ…</h2>
<pre><code class="language-kotlin">@Composable
fun NewsStory() {
    MaterialTheme/*éµå¾ª MaterialThemeæ¿å¼*/ {
        val typography = MaterialTheme.typography/*ç‰ˆå¼å³TextStyle*/
        //val image= ImageBitmap.imageResource(R.drawable.header)/*å¼ƒç”¨*/
        val image2 = painterResource(R.drawable.header)/*BitmapPainter or VectorPainter*/
        Column(modifier = Modifier.padding(16.dp)) {
            val modifier = Modifier
                /*å³preferredHeightæœŸæœ›é«˜åº¦ï¼Œå¯èƒ½æ”¹å˜ã€‚ä¸å˜ç”¨requiredHeightï¼ŒèŒƒå›´ç”¨heightIn*/
                .height(180.dp)
                .fillMaxWidth()/*å¯è®¾ç½®ç™¾åˆ†æ¯”ï¼Œé»˜è®¤1ã€‚å…·ä½“ç”¨widthï¼Œæˆ–sizeåŒæ—¶è®¾ç½®*/
                .clip(RoundedCornerShape(4.dp))/*Material DesignåŒ…*/
            Image(
                painter = image2,
                contentDescription = &quot;image&quot;,
                modifier = modifier,/*ScaleType*/
                contentScale = ContentScale.Crop
            )
            Spacer(modifier = Modifier.height(16.dp))/*é—´éš”*/
            Text(
                text = &quot;A day wandering through the sandhill &quot; +
                        &quot;in Shark Fin Cove, and a few of the &quot; +
                        &quot;sights I saw&quot;,
                style = typography.h6/*å®šä¹‰å¥½çš„TextStyle*/,
                maxLines = 2,
                overflow = TextOverflow.Ellipsis
            )
            Text(text = &quot;Davenport,California&quot;,style = typography.body2)
            Text(text = &quot;December 2018&quot;,style = typography.body2)
        }
    }
}
</code></pre>
<h2 id="é‡ç»„">é‡ç»„</h2>
<p>é‡ç»„æ˜¯æŒ‡åœ¨è¾“å…¥æ›´æ”¹æ—¶ï¼Œå†æ¬¡è°ƒç”¨å¯ç»„åˆå‡½æ•°çš„è¿‡ç¨‹ã€‚</p>
<ul>
<li>åœ¨å‘½ä»¤å¼ç•Œé¢æ¨¡å‹ä¸­ï¼Œå¦‚éœ€æ›´æ”¹æŸä¸ªå¾®ä»¶ï¼Œæ‚¨å¯ä»¥åœ¨è¯¥å¾®ä»¶ä¸Šè°ƒç”¨ setter ä»¥æ›´æ”¹å…¶å†…éƒ¨çŠ¶æ€ã€‚</li>
<li>åœ¨å£°æ˜å¼Compose ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ–°æ•°æ®å†æ¬¡è°ƒç”¨å¯ç»„åˆå‡½æ•°ã€‚</li>
</ul>
<p>è¿™æ ·åšä¼šå¯¼è‡´å‡½æ•°è¿›è¡Œé‡ç»„ -- ç³»ç»Ÿä¼šæ ¹æ®éœ€è¦ï¼Œä½¿ç”¨æ–°æ•°æ®é‡æ–°ç»˜åˆ¶å‡½æ•°å‘å‡ºçš„å¾®ä»¶ã€‚ä¸ä¾èµ–äºè¯¥æ•°æ®çš„å…¶ä»–å‡½æ•°è·³è¿‡ï¼Œä¸ä¼šè¿›è¡Œé‡ç»„ã€‚</p>
<p>åœ¨ Compose ä¸­ç¼–ç¨‹æ—¶ï¼Œæœ‰è®¸å¤šäº‹é¡¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>
<p>å¯ç»„åˆå‡½æ•°å¯ä»¥æŒ‰ä»»ä½•é¡ºåºæ‰§è¡Œã€å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚ä¸”é‡ç»„ä¼šè·³è¿‡å°½å¯èƒ½å¤šçš„å¯ç»„åˆå‡½æ•°å’Œ lambdaã€‚</p>
<p>å› æ­¤æ¯ä¸ªå¯é‡ç»„å‡½æ•°åº”ä¿æŒç‹¬ç«‹ï¼Œä¸”ä¸åº”æœ‰é™„å¸¦æ•ˆåº”ã€‚</p>
</li>
<li>
<p>é‡ç»„æ˜¯ä¹è§‚çš„æ“ä½œï¼Œå¯èƒ½ä¼šè¢«å–æ¶ˆã€‚</p>
</li>
<li>
<p>å¯ç»„åˆå‡½æ•°å¯èƒ½ä¼šåƒåŠ¨ç”»çš„æ¯ä¸€å¸§ä¸€æ ·éå¸¸é¢‘ç¹åœ°è¿è¡Œã€‚</p>
</li>
</ul>
<pre><code class="language-kotlin">@Composable
@Deprecated(&quot;Example with bug&quot;)
fun ListWithBug(myList: List&lt;String&gt;) {
    var items = 0
    Row(horizontalArrangement = Arrangement.SpaceBetween) {
        Column {
            for (item in myList) {
                Text(&quot;Item: $item&quot;)
                items++ // Avoid! Side-effect of the column recomposing.
            }
        }
        Text(&quot;Count: $items&quot;)
    }
}
</code></pre>
<pre><code class="language-kotlin">/**
 * Display a list of names the user can click with a header
 */
@Composable
fun NamePicker(
    header: String,
    names: List&lt;String&gt;,
    onNameClicked: (String) -&gt; Unit
) {
    Column {
        // this will recompose when [header] changes, but not when [names] changes
        Text(header, style = MaterialTheme.typography.h5)
        Divider()

        // LazyColumnFor is the Compose version of a RecyclerView.
        // The lambda passed is similar to a RecyclerView.ViewHolder.
        LazyColumnFor(names) { name -&gt;
            // When an item's [name] updates, the adapter for that item
            // will recompose. This will not recompose when [header] changes
            NamePickerItem(name, onNameClicked)
        }
    }
}

/**
 * Display a single name the user can click.
 */
@Composable
private fun NamePickerItem(name: String, onClicked: (String) -&gt; Unit) {
    Text(name, Modifier.clickable(onClick = { onClicked(name) }))
}
</code></pre>
<h2 id="state">State</h2>
<pre><code class="language-kotlin">fun MyScreenContent() {
    val countState = remember {
        mutableStateOf(0)
    }
    Column {
        Counter()
        Counter2(count = countState.value,updateCount = {newCount-&gt;
            countState.value=newCount
        })
    }
}

@Composable
fun Counter() {
    val count = remember {
        mutableStateOf(0)
    }
    Button(onClick = { count.value++ }) {
        Text(text = &quot;${count.value} times&quot;)
    }
}
@Composable
fun Counter2(count:Int,updateCount:(Int)-&gt;Unit) {
    Button(onClick = { updateCount(count+1) }) {
        Text(text = &quot;$count times&quot;)
    }
}
</code></pre>
<h2 id="lazycolumn">LazyColumn</h2>
<pre><code class="language-kotlin">@Composable
fun NameList(names: List&lt;String&gt;, modifier: Modifier = Modifier) {
    LazyColumn(modifier = modifier) {
        items(items = names) { name -&gt;
            Greeting(name = name)
            Divider(color = Color.Black)
        }
    }
}
Column(modifier = Modifier.fillMaxHeight()) {
    NameList(names, Modifier.weight(1f))
    Counter2(count = countState.value, updateCount = { newCount -&gt;
        countState.value = newCount
    })
}
</code></pre>
<pre><code class="language-kotlin">@Composable
fun Greeting(name: String) {
    /*byå§”æ‰˜ï¼šå°†set/getå§”æ‰˜å‡ºå»*/
    var isSelected by /*Boolean*/remember { mutableStateOf(false) }
    val backgroundColor by /*å§”æ‰˜State&lt;Color&gt;*/animateColorAsState(if (isSelected) Color.Red else Color.Transparent)
    Text(text = &quot;hello $name&quot;,
        modifier = Modifier
            .padding(24.dp)
            .background(color = backgroundColor)
            .clickable(onClick = { isSelected = !isSelected })
    )
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Navigatoræºç åˆ†æ]]></title>
        <id>https://Joshua-Chang.github.io/post/navigator-yuan-ma-fen-xi/</id>
        <link href="https://Joshua-Chang.github.io/post/navigator-yuan-ma-fen-xi/">
        </link>
        <updated>2020-12-14T16:54:12.000Z</updated>
        <content type="html"><![CDATA[<h3 id="è®¨è®ºæ¡ˆä¾‹">è®¨è®ºæ¡ˆä¾‹</h3>
<pre><code class="language-xml">activity_main.xml

&lt;fragment
    android:id=&quot;@+id/nav_host_fragment&quot;
    android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    app:defaultNavHost=&quot;true&quot;
    app:navGraph=&quot;@navigation/mobile_navigation&quot; /&gt;

mobile_navigation.xml

&lt;navigation
    android:id=&quot;@+id/mobile_navigation&quot;
    app:startDestination=&quot;@id/navigation_home&quot;&gt;
    &lt;fragment
        android:id=&quot;@+id/navigation_home&quot;
        android:name=&quot;org.devio.as.hi.hirouter.ui.home.HomeFragment&quot;
        tools:layout=&quot;@layout/fragment_home&quot;&gt;
        &lt;argument
            android:name=&quot;name&quot;
            app:argType=&quot;string&quot;
            app:nullable=&quot;true&quot; /&gt;
        &lt;action
            android:id=&quot;@+id/action_navigation_home_to_navigation_notifications&quot;
            app:destination=&quot;@id/navigation_notifications&quot;
            app:launchSingleTop=&quot;true&quot;
            app:popUpTo=&quot;@id/navigation_notifications&quot; /&gt;
        &lt;deepLink
            android:id=&quot;@+id/deepLink&quot;
            app:uri=&quot;www.imooc.com&quot; /&gt;
    &lt;/fragment&gt;
&lt;/navigation&gt;
</code></pre>
<h3 id="navhostfragmentoninflate">NavHostFragment.onInflate:</h3>
<p>å»æŸ¥æ‰¾å£°æ˜åœ¨NavHostFragmentçš„xmlå¸ƒå±€æ–‡ä»¶ä¸­çš„ï¼ŒdefaultNavHostã€navGraphå±æ€§,å¾—åˆ°mGraphId</p>
<pre><code class="language-kotlin">onInflateï¼šä»»ä½•èƒ½åœ¨xmlå¸ƒå±€æ–‡ä»¶ä¸­å£°æ˜çš„ç»„å»ºï¼Œå½“å®ƒä»¬è¢«ä»xmlè§£æå®Œæˆï¼Œè¢«åˆ›å»ºæˆåŠŸåéƒ½ä¼šè°ƒç”¨æ­¤æ–¹æ³•
activityå’Œdialogæ˜¯ä¸å¯ä»¥çš„ï¼Œå› ä¸ºä»–ä»¬ä¸èƒ½åœ¨xmlå¸ƒå±€æ–‡ä»¶ä¸­ç›´æ¥å£°æ˜
    @CallSuper
    @Override
    public void onInflate(@NonNull Context context, @NonNull AttributeSet attrs,
            @Nullable Bundle savedInstanceState) {
        super.onInflate(context, attrs, savedInstanceState);

        final TypedArray navHost = context.obtainStyledAttributes(attrs, R.styleable.NavHost);
        final int graphId = navHost.getResourceId(R.styleable.NavHost_navGraph, 0);
        if (graphId != 0) {
            mGraphId = graphId;
        }
        navHost.recycle();

        final TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.NavHostFragment);
        final boolean defaultHost = a.getBoolean(R.styleable.NavHostFragment_defaultNavHost, false);
        if (defaultHost) {
            mDefaultNavHost = true;
        }
        a.recycle();
    }
</code></pre>
<h3 id="navhostfragmentoncreate">NavHostFragment.onCreate:</h3>
<ul>
<li>å¾€NavigatorProviderå†…addNavigatorï¼š</li>
</ul>
<p>æ„é€ NavHostControlleræ–¹æ³•å†…ï¼Œå…ˆæ·»åŠ ä¸å¯æˆ–ç¼ºçš„ActivityNavigatorã€å’ŒNavGraphNavigator ï¼ˆ<navigation/>startDestinationï¼‰</p>
<p>onCreateNavControlleræ–¹æ³•å†…ï¼Œæ·»åŠ DialogFragmentNavigatorï¼ŒFragmentNavigatorï¼Œä»¥æ”¯æŒdialogã€fragmentç±»å‹çš„å¯¼èˆªè·³è½¬</p>
<ul>
<li>é…ç½®å›é€€æ ˆ</li>
<li>NavController.setGraph(mGraphId)ã€‚æŠŠå£°æ˜åœ¨NavHostFragmentçš„app:navGraphçš„idï¼Œäº¤ç»™NavControllerå¤„ç†ï¼ˆå’ŒfragmentControllerè®¾è®¡åŸå› ä¸€æ ·ï¼Œéš”ç¦»ä½œç”¨ï¼‰</li>
</ul>
<pre><code class="language-kotlin">NavHostFragment:
@CallSuper
@Override
public void onCreate(@Nullable Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    final Context context = requireContext();
		//æ„å»ºNavControllerå¯¹è±¡ å†…éƒ¨ç«‹å³æ³¨å†Œä¸¤ä¸ªNavigatorï¼šstartã€activityçš„
    mNavController = new NavHostController(context);//ç»§æ‰¿è‡ªNavController
		//è®¾ç½®å›é€€æ ˆ
    mNavController.setOnBackPressedDispatcher(requireActivity().getOnBackPressedDispatcher());
	  //...
		//é€šè¿‡controllerå¾—åˆ°Providerï¼Œå¹¶å¯¹å…¶æ³¨å†ŒDialogFragmentNavigatorï¼ŒFragmentNavigatorã€‚ä»¥æ”¯æŒdialogã€fragmentç±»å‹çš„å¯¼èˆªè·³è½¬
    onCreateNavController(mNavController);
    //ã€‚ã€‚ã€‚

        //æŠŠå£°æ˜åœ¨NavHostFragmentçš„xmlå¸ƒå±€æ–‡ä»¶ä¸­çš„èµ„æºid
				//app:navGraph=&quot;@navigation/mobile_navigation&quot;ï¼ˆnavGraphå±æ€§ï¼‰
				//äº¤ç»™NavControllerå¤„ç†ï¼ˆå’ŒfragmentControllerè®¾è®¡åŸå› ä¸€æ ·ï¼Œéš”ç¦»ä½œç”¨ï¼‰
        mNavController.setGraph(mGraphId);
}
//é€šè¿‡controllerå¾—åˆ°Providerï¼ˆå­˜å‚¨ä¸€ä¸ªä¸ªnavigatorå¯¹è±¡ï¼‰ï¼Œ
//å¹¶æ³¨å†ŒDialogFragmentNavigatorï¼ŒFragmentNavigatorï¼Œä»¥æ”¯æŒdialogã€fragmentç±»å‹çš„å¯¼èˆªè·³è½¬
protected void onCreateNavController(@NonNull NavController navController) {
        navController.getNavigatorProvider().addNavigator(
                new DialogFragmentNavigator(requireContext(), getChildFragmentManager()));
        navController.getNavigatorProvider().addNavigator(createFragmentNavigator());
    }

//ç«‹å³æ³¨å†Œä¸¤ä¸ªNavigator
NavControllerï¼š
public NavController(@NonNull Context context) {
//....è·¯ç”±é¦–é¡µå’Œactivityéƒ½æ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼Œä½†fragmentNavigatoræœªå¿…ï¼Œæ‰€ä»¥è¿™é‡Œæ³¨å†Œäº†ä¸¤ä¸ª
//mobile_navigation.xmlèµ„æºæ–‡ä»¶åŠ è½½å®Œï¼Œç”¨æ¥å¯åŠ¨å…¶ä¸­çš„startDestinationå¯¹åº”çš„é¡µé¢çš„
        mNavigatorProvider.addNavigator(new NavGraphNavigator(mNavigatorProvider));
//èƒ½ç»™activityæä¾›è·¯ç”±æœåŠ¡çš„navigator
        mNavigatorProvider.addNavigator(new ActivityNavigator(mContext));
    }
//è®¾ç½®dispatcheråå°†mOnBackPressedCallbackåŠ å…¥callback
void setOnBackPressedDispatcher(@NonNull OnBackPressedDispatcher dispatcher) {
	      //...
        dispatcher.addCallback(mLifecycleOwner, mOnBackPressedCallback);
    }

private final OnBackPressedCallback mOnBackPressedCallback =
            new OnBackPressedCallback(false) {
        @Override
        public void handleOnBackPressed() {
            popBackStack();//å›é€€æ ˆ
        }
    };
</code></pre>
<h3 id="navinflaterinflate">NavInflater().inflate</h3>
<p>è§£æè·¯ç”±èµ„æºæ–‡ä»¶è¿”å›NavGraphå¯¹è±¡ï¼šç”±è·¯ç”±èµ„æºxmlå®šä¹‰çš„èŠ‚ç‚¹åï¼Œå¾—åˆ°ç›¸åº”ç±»å‹çš„Navigatorï¼Œåœ¨å»åˆ›å»ºç›¸åº”ç±»å‹çš„DestinationèŠ‚ç‚¹ã€‚</p>
<p><navigation/>ç‰¹æ®Šï¼šä¼šå¾—åˆ°NavGraphNavigatorç±»å‹çš„navigatorï¼Œå¹¶åˆ›å»ºå‡ºNavGraphç±»å‹çš„èŠ‚ç‚¹ã€‚</p>
<p>NavGraphæ˜¯ç‰¹æ®Šçš„DestinationèŠ‚ç‚¹ï¼š</p>
<ul>
<li>æˆå‘˜ï¼šå«app:startDestinationçš„idï¼Œå’ŒSparseArrayCompat<NavDestination>çš„è·¯ç”±èŠ‚ç‚¹é›†åˆ</li>
<li>è‡ªå·±å¯ä»¥åµŒå¥—è‡ªå·±ï¼Œå³mobile_navigation.xmlå†…çš„<navigation/>æ ‡ç­¾å†…è¿˜å¯ä»¥æœ‰<navigation/>å½¢æˆä¸€ä¸ªä¸ªçš„è·¯ç”±ç»„ï¼Œä¸”æ¯ç»„ä»¥å„è‡ªçš„app:startDestinationä¸ºèµ·å§‹ç‚¹</li>
<li>NavInflater().inflateæ—¶é‡åˆ°NavGraphç±»å‹çš„èŠ‚ç‚¹ï¼Œé€’å½’è°ƒç”¨inflateï¼Œå°†è‡ªèŠ‚ç‚¹åŠ å…¥å…¶è·¯ç”±èŠ‚ç‚¹é›†åˆ</li>
</ul>
<p>onGraphCreatedï¼šè·¯ç”±æ–‡ä»¶è§£æ/èŠ‚ç‚¹åˆ›å»ºå®Œæ¯•ï¼Œå¼€å§‹è·¯ç”±è·³è½¬æµç¨‹NavController.navigate</p>
<pre><code class="language-kotlin">NavControllerï¼š
		@CallSuper
    public void setGraph(@NavigationRes int graphResId, @Nullable Bundle startDestinationArgs) {
        setGraph(getNavInflater().inflate(graphResId)/*å¾—åˆ°NavGraph*/, startDestinationArgs);
    }

		public void setGraph(@NonNull NavGraph graph, @Nullable Bundle startDestinationArgs) {
        if (mGraph != null) {
            // Pop everything from the old graph off the back stack
            popBackStackInternal(mGraph.getId(), true);
        }
        mGraph = graph;//å°†å¾—åˆ°çš„NavGraphä¿å­˜èµ·æ¥
				//ç¬¬ä¸€é˜¶æ®µï¼šè·¯ç”±æ–‡ä»¶è§£æèŠ‚ç‚¹åˆ›å»ºæµç¨‹å®Œæ¯•
        onGraphCreated(startDestinationArgs);
				//å†…éƒ¨ä¼šè°ƒç”¨navigate(mGraph, startDestinationArgs, null, null);å¯åŠ¨ç¬¬ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹//ç¬¬äºŒé˜¶æ®µè·¯ç”±è·³è½¬æµç¨‹å¼€å§‹					
  }

NavInflaterï¼š
//layoutInflaterä¸“é—¨è§£æå¸ƒå±€èµ„æºæ–‡ä»¶ï¼ŒNavInflaterä¸“é—¨è§£æè·¯ç”±èµ„æºæ–‡ä»¶ï¼Œè¿”å›NavGraphå¯¹è±¡
public NavGraph inflate(@NavigationRes int graphResId) {
      //ã€‚ã€‚ã€‚è·¯ç”±xmlæ–‡ä»¶ï¼ˆapp:navGraph=&quot;@navigation/mobile_navigation&quot;ï¼‰çš„è§£æ
			//ç”Ÿäº§è·¯ç”±èŠ‚ç‚¹å¯¹è±¡
			NavDestination destination = inflate(res, parser, attrs, graphResId);
			if (!(destination instanceof NavGraph)) {//å¦‚æœè¿”å›ç»“æœä¸æ˜¯NavGraphç±»å‹åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å³mobile_navigation.xmlæ ¹ç»“ç‚¹å¿…é¡»&lt;navigation/&gt;æ ‡ç­¾
                throw new IllegalArgumentException(&quot;Root element &lt;&quot; + rootElement + &quot;&gt;&quot;
                        + &quot; did not inflate into a NavGraph&quot;);
            }
            return (NavGraph) destination;
    }

private NavDestination inflate(@NonNull Resources res, @NonNull XmlResourceParser parser,
            @NonNull AttributeSet attrs, int graphResId)
            throws XmlPullParserException, IOException {
//æ ¹æ®mobile_navigation.xmlä¸­çš„å®šä¹‰çš„èŠ‚ç‚¹ç±»å‹ï¼Œ
//ç‰¹æ®Šï¼šmobile_navigation.xmlä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸ºnavigationè§£æå‡ºNavGraphNavigatorç±»å‹çš„navigatorå¯¼èˆª
//æ­£å¸¸ï¼šåè¾¹çš„èŠ‚ç‚¹ä¸ºactivity/fragmentç­‰ï¼Œè§£æå‡ºfragmentnavigator/activitynavigatorç­‰ç±»å‹çš„navigator
        Navigator&lt;?&gt; navigator = mNavigatorProvider.getNavigator(parser.getName());
//ä½¿ç”¨navigatoråˆ›å»ºDestinationèŠ‚ç‚¹ï¼ˆADestination/FDestinationç­‰ï¼‰ï¼Œä»¥activityNavigatorä¸ºä¾‹
//ä½¿ç”¨NavGraphNavigatoråˆ›å»ºå‡ºNavGraph
        final NavDestination dest = navigator.createDestination();
        dest.onInflate(mContext, attrs);//NavDestinationèŠ‚ç‚¹ï¼ˆå…·ä½“æ˜¯å­ç±»activityæˆ–fragmentï¼‰è§£æå¡«å……
				//...
        while ((type = parser.next()) != XmlPullParser.END_DOCUMENT
              // ....
            } else if (dest instanceof NavGraph) {//å¦‚æœèŠ‚ç‚¹æ˜¯NavGraphåˆ™é€’å½’è°ƒç”¨è‡ªå·±ï¼Œç»§ç»­è§£æå¹¶åŠ å…¥åˆ°NavGraphçš„èŠ‚ç‚¹é›†åˆä¸­
                ((NavGraph) dest).addDestination(inflate(res, parser, attrs, graphResId));
            }
        }
        return dest;
}

ActivityNavigatorï¼š
public Destination createDestination() {
        return new Destination(this);//ä¼ å…¥navigatorè‡ªå·±
    }
ActivityNavigator$Destination
public static class Destination extends NavDestination{
	super(activityNavigator);//è°ƒçˆ¶ç±»NavDestination
}

NavDestinationèŠ‚ç‚¹:çš„æ„é€ éœ€è¦åˆ›å»ºNavDestinationçš„Navigatorï¼Œæˆ–navigatorName
//æ— è®ºæ˜¯activityè¿˜æ˜¯fragmentç±»å‹çš„èŠ‚ç‚¹ï¼Œ
//åˆ›å»ºæ—¶éƒ½éœ€è¦æŠŠåˆ›å»ºä»–çš„Navigatorä¼ é€’è¿›æ¥ï¼Œä»¥ä¾¿æ­£ç¡®çš„è·³è½¬
//ä»è€ŒæŠŠDestinationèŠ‚ç‚¹å’Œåˆ›å»ºä»–çš„Navigatorå¯¼èˆª å…³è”èµ·æ¥
public NavDestination(@NonNull Navigator&lt;? extends NavDestination&gt; navigator) {}
public NavDestination(@NonNull String navigatorName) {}

NavGraphNavigatorï¼šç‰¹æ®ŠNavigator
public NavGraph createDestination() {
        return new NavGraph(this);
    }
NavGraphï¼šç‰¹æ®ŠDestinationèŠ‚ç‚¹ï¼Œè‡ªå·±å¯ä»¥åµŒå¥—è‡ªå·±ï¼Œ
å³mobile_navigation.xmlå†…çš„&lt;navigation/&gt;æ ‡ç­¾å†…è¿˜å¯ä»¥æœ‰&lt;navigation/&gt;
å½¢æˆä¸€ä¸ªä¸ªçš„è·¯ç”±ç»„ï¼Œä¸”æ¯ç»„ä»¥å„è‡ªçš„app:startDestinationä¸ºèµ·å§‹ç‚¹
ä¾‹å­ï¼šç”µå•†äº¤æ˜“æ”¯ä»˜å®Œæˆåï¼Œå°†ä¸€ç»„éƒ½å…³é—­

NavGraph extends NavDestination implements Iterable&lt;NavDestination&gt; {
    final SparseArrayCompat&lt;NavDestination&gt; mNodes = new SparseArrayCompat&lt;&gt;();//è·¯ç”±èŠ‚ç‚¹çš„é›†åˆ
    private int mStartDestId;//è¯¥é›†åˆçš„å¯åŠ¨ID app:startDestination=&quot;@id/navigation_home&quot;
    private String mStartDestIdName;
}
</code></pre>
<h3 id="navcontrollernavigate">NavController.navigate</h3>
<p>ç¬¬äºŒé˜¶æ®µè·¯ç”±è·³è½¬æµç¨‹å¼€å§‹</p>
<p>æ ¹æ®NavGraphè¿™ä¸€ç‰¹æ®ŠèŠ‚ç‚¹çš„nameï¼Œå¾—åˆ°NavGraphNavigatorå¯¹è±¡</p>
<pre><code class="language-kotlin">private void navigate(@NonNull NavDestination node, @Nullable Bundle args,
        @Nullable NavOptions navOptions, @Nullable Navigator.Extras navigatorExtras) {
    //...
    Navigator&lt;NavDestination&gt; navigator = mNavigatorProvider.getNavigator(
            node.getNavigatorName());//æ ¹æ®NavGraphçš„nameï¼Œæ‰¾åˆ›å»ºè¯¥èŠ‚ç‚¹çš„åˆ°navigatorå¯¹è±¡ å³NavGraphNavigatorå¯¹è±¡
    Bundle finalArgs = node.addInDefaultArgs(args);
    NavDestination newDest = navigator.navigate(node, finalArgs,//ç„¶åå‘èµ·çœŸæ­£çš„è·¯ç”±
            navOptions, navigatorExtras);
    mBackStack.add(entry);//æŠŠè·¯ç”±èŠ‚ç‚¹æ·»åŠ åˆ°å›é€€æ ˆ
}
</code></pre>
<h3 id="navgraphnavigatornavigate">NavGraphNavigator.navigate</h3>
<p>æ‰¾åˆ°<navigator/>å†… çš„startDestinationèŠ‚ç‚¹</p>
<p>æ ¹æ®startDestinationèŠ‚ç‚¹çš„nameï¼Œåœ¨NavigatorProvideré‡Œæ‰¾åˆ°åˆ›å»ºä»–çš„å…·ä½“çš„f/a/dialogç­‰ç±»å‹çš„Navigator</p>
<p>å†è®©å…·ä½“f/a/dialogç­‰ç±»å‹çš„Navigatorå»å¤„ç†è·¯ç”±</p>
<pre><code class="language-kotlin">NavGraphNavigatorï¼š
public NavDestination navigate(@NonNull NavGraph destination, @Nullable Bundle args,
        @Nullable NavOptions navOptions, @Nullable Extras navigatorExtras) {
    int startId = destination.getStartDestination();//app:startDestinationçš„id

		//æ ¹æ®app:startDestinationçš„idæ‰¾åˆ°ç›¸åº”çš„startDestinationèŠ‚ç‚¹
    NavDestination startDestination = destination.findNode(startId, false);
	
		//æ ¹æ®startDestinationèŠ‚ç‚¹çš„nameå±æ€§ï¼Œæ‰¾åˆ°åˆ›å»ºä»–çš„å…·ä½“navigator
    Navigator&lt;NavDestination&gt; navigator = mNavigatorProvider.getNavigator(
            startDestination.getNavigatorName());//æ­¤æ—¶çš„navigatorå¯èƒ½æ˜¯f/a/dialogç­‰ç±»å‹çš„Navigator
		//å†å°†è·¯ç”±æ“ä½œå§”æ‰˜ç»™f/a/dialogç­‰ç±»å‹çš„Navigator
    return navigator.navigate(startDestination, startDestination.addInDefaultArgs(args),
            navOptions, navigatorExtras);
}

1ã€activityNavigator

public NavDestination navigate(@NonNull Destination destination, @Nullable Bundle args,
            @Nullable NavOptions navOptions, @Nullable Navigator.Extras navigatorExtras) {
				//æ„é€ intent
        Intent intent = new Intent(destination.getIntent());
        if (args != null) {
            intent.putExtras(args);//æ·»åŠ args
            //ã€‚ã€‚ã€‚
        }
				//é…ç½®å¯åŠ¨æ¨¡å¼
        if (!(mContext instanceof Activity)) {
            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        }
        if (navOptions != null &amp;&amp; navOptions.shouldLaunchSingleTop()) {
            intent.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
        }

				//è¿›å‡ºåŠ¨ç”»ç­‰ã€‚ã€‚ã€‚

				mContext.startActivity(intent);//é€šè¿‡startActivityå®Œæˆè·¯ç”±
    }

2ã€fragmentNavigator

public NavDestination navigate(@NonNull Destination destination, @Nullable Bundle args,
            @Nullable NavOptions navOptions, @Nullable Navigator.Extras navigatorExtras) {
        String className = destination.getClassName();//æ ¹æ®destinationèŠ‚ç‚¹å¾—åˆ°ç±»å
        if (className.charAt(0) == '.') {
            className = mContext.getPackageName() + className;
        }
        final Fragment frag = instantiateFragment(mContext, mFragmentManager,
                className, args);//æ ¹æ®ç±»ååå°„å¾—åˆ°fragmentå®ä¾‹
        frag.setArguments(args);//è®¾ç½®args
        final FragmentTransaction ft = mFragmentManager.beginTransaction();//å¼€å¯äº‹åŠ¡
				
        //è¿›å‡ºåŠ¨ç”»ç­‰ã€‚ã€‚ã€‚

        ft.replace(mContainerId, frag);
				//æ­¤å¤„ä½¿ç”¨çš„æ˜¯replaceï¼Œå› æ­¤ä½¿ç”¨Navigatorè·¯ç”±æ—¶åˆ‡æ¢fragmentæ—¶ï¼Œå£°æ˜å‘¨æœŸé‡æ–°æ‰§è¡Œ
    }

3ã€dialogFragmentNavigator
public NavDestination navigate(@NonNull final Destination destination, @Nullable Bundle args,
            @Nullable NavOptions navOptions, @Nullable Navigator.Extras navigatorExtras) {
        String className = destination.getClassName();
        if (className.charAt(0) == '.') {
            className = mContext.getPackageName() + className;
        }
        final Fragment frag = mFragmentManager.getFragmentFactory().instantiate(
                mContext.getClassLoader(), className);//åå°„
        if (!DialogFragment.class.isAssignableFrom(frag.getClass())) {//ç±»å‹åˆ¤æ–­ï¼šæ˜¯å¦æ—¶dialogFragmentç±»å‹çš„
            throw new IllegalArgumentException(&quot;Dialog destination &quot; + destination.getClassName()
                    + &quot; is not an instance of DialogFragment&quot;);
        }
        final DialogFragment dialogFragment = (DialogFragment) frag;//ä¸Šæ–‡ä»¥ç¡®å®šä¸ºdialogFragment
        dialogFragment.setArguments(args);//æ·»åŠ args
        dialogFragment.getLifecycle().addObserver(mObserver);

				//showå‡ºdialogFragment
        dialogFragment.show(mFragmentManager, DIALOG_TAG + mDialogCount++);
        return destination;
    }
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://Joshua-Chang.github.io/post-images/1607965068319.png" alt="" loading="lazy"></figure>
<h3 id="ç¼ºç‚¹">ç¼ºç‚¹ï¼š</h3>
<ol>
<li>èŠ‚ç‚¹å¿…é¡»åœ¨è·¯ç”±æ–‡ä»¶mobile_navigation.xmlä¸­å®šä¹‰</li>
<li>fragmentç±»å‹èŠ‚ç‚¹çš„è·¯ç”±æ“ä½œï¼Œæ˜¯ä½¿ç”¨replaceï¼Œä¼šå¯¼è‡´fragmenté¡µé¢å£°æ˜å‘¨æœŸé‡å¯ï¼Œæ•°æ®çš„é‡æ–°åŠ è½½</li>
<li>ä¸æ”¯æŒè·¯ç”±è¿‡ç¨‹çš„æ‹¦æˆªç›‘å¬</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://Joshua-Chang.github.io/post/hello-gridea/</id>
        <link href="https://Joshua-Chang.github.io/post/hello-gridea/">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Update MacOS to Mojave Vim: Caught deadly signal SEGV]]></title>
        <id>https://Joshua-Chang.github.io/post/Update-MacOS-to-Mojave-Vim-Caught-deadly-signal-SEGVE/</id>
        <link href="https://Joshua-Chang.github.io/post/Update-MacOS-to-Mojave-Vim-Caught-deadly-signal-SEGVE/">
        </link>
        <updated>2018-10-24T03:51:37.000Z</updated>
        <content type="html"><![CDATA[<h5 id="ææœ‰å¯èƒ½æ˜¯youcompletemeæˆ–è€…powerlineç­‰æ’ä»¶çš„é—®é¢˜">ææœ‰å¯èƒ½æ˜¯<em>YouCompleteMe</em>æˆ–è€…<em>Powerline</em>ç­‰æ’ä»¶çš„é—®é¢˜</h5>
<pre><code class="language-bash">Vim: Caught deadly signal SEGV

Error detected while processing function &lt;SNR&gt;78_PollServerReady[7]..&lt;SNR&gt;78_Pyeval:Vim: Finished.

line    4:
Exception MemoryError: MemoryError() in &lt;module 'threading' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/threading.pyc'&gt; ignored
[1]    72868 segmentation fault  vim Test.java
</code></pre>
<h5 id="è§£å†³">è§£å†³ï¼š</h5>
<pre><code class="language-bash">brew install vim --with-lua --with-override-system-vi
</code></pre>
<p>and restart shell , fixed</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Appä½¿ç”¨ç»Ÿè®¡ä¸é™é»˜æ‹æ‘„]]></title>
        <id>https://Joshua-Chang.github.io/post/Appæ—¶å¸¸ç»Ÿè®¡ä¸é™é»˜æ‹æ‘„/</id>
        <link href="https://Joshua-Chang.github.io/post/Appæ—¶å¸¸ç»Ÿè®¡ä¸é™é»˜æ‹æ‘„/">
        </link>
        <updated>2018-10-03T10:29:46.000Z</updated>
        <content type="html"><![CDATA[<h3 id="appä½¿ç”¨ç»Ÿè®¡">Appä½¿ç”¨ç»Ÿè®¡</h3>
<p>ç›‘æ§æˆ–ç»Ÿè®¡æ‰‹æœºå†…çš„appä½¿ç”¨æƒ…å†µå¯ä»¥ä»ä¸¤ä¸ªæ€è·¯è€ƒè™‘</p>
<ul>
<li>
<p>ç»Ÿè®¡æ¯ä¸ªappçš„ä½¿ç”¨æ—¶é•¿</p>
<p>UsageStatsManagerè¿™ä¸€ç»Ÿè®¡ç®¡ç†ç±»ï¼Œå¯ä»¥æŸ¥å‡ºæ¯ä¸ªappç®€å•çš„æœ€è¿‘å¼€å¯æ—¶é—´ã€æŸæ—¶é™å†…çš„ä½¿ç”¨æ—¶é•¿ç­‰ä¿¡æ¯ã€‚æ›´å¤æ‚çš„æ‰‹æœºäº®å±æ¬¡æ•°ï¼Œå¼€å¯<!--more-->åº”ç”¨æ¬¡æ•°å¯ä»¥ä½¿ç”¨UsageStatsServiceæˆ–è€…è¿‡æ»¤åŒ…åçš„å½¢å¼ç»Ÿè®¡ã€‚</p>
</li>
<li>
<p>ç»Ÿè®¡æ¯ä¸ªAndroidç³»ç»Ÿè€—ç”µæƒ…å†µçš„æ¯ä¸ªappå æ¯”</p>
<p>åœ¨åšç”µé‡ä¼˜åŒ–çš„æ—¶å€™ç»å¸¸ä¼šé€šè¿‡adbä½¿ç”¨Battery-Historianåˆ†æç”µé‡æŠ¥å‘Šï¼Œæ‰€ä»¥ç”±æ­¤çµæ„Ÿï¼Œå…·ä½“çš„å®ç°è¿˜éœ€è¦å¤´è„‘é£æš´ä¸€ä¸‹ã€‚</p>
</li>
</ul>
<h5 id="å¯¹appä½¿ç”¨æ—¶å¸¸ç»Ÿè®¡çš„ç®€å•å®ç°">å¯¹appä½¿ç”¨æ—¶å¸¸ç»Ÿè®¡çš„ç®€å•å®ç°</h5>
<ol>
<li>
<p>å¼€å¯ACTION_USAGE_ACCESS_SETTINGSæƒé™</p>
<figure data-type="image" tabindex="1"><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fvv9r2lhoyj308r0fkt9b.jpg" alt="" loading="lazy"></figure>
</li>
<li>
<p>å¾—åˆ°ä½¿ç”¨åˆ†æç®¡ç†UsageStatsManagerå¹¶æ ¹æ®æ—¶é™æŸ¥è¯¢ç»Ÿè®¡çŠ¶æ€</p>
<pre><code class="language-java">UsageStatsManager manager = (UsageStatsManager) getApplicationContext().getSystemService(USAGE_STATS_SERVICE);
List&lt;UsageStats&gt; stats = manager.queryUsageStats(UsageStatsManager.INTERVAL_MONTHLY, beginCal.getTimeInMillis(), endCal.getTimeInMillis());
</code></pre>
</li>
<li>
<p>æ ¹æ®UsageStatsæŸ¥è¯¢æ¯ä¸ªappçš„ç»Ÿè®¡ä¿¡æ¯</p>
<pre><code class="language-java">for (UsageStats us : stats) {
    try {
        PackageManager pm = getApplicationContext().getPackageManager();
        ApplicationInfo applicationInfo = pm.getApplicationInfo(us.getPackageName(), PackageManager.GET_META_DATA);
        if ((applicationInfo.flags &amp; applicationInfo.FLAG_SYSTEM) &lt;= 0) {
            sb.append(pm.getApplicationLabel(applicationInfo)+&quot; ä½¿ç”¨æ—¶é•¿ï¼š&quot;+formatTime(us.getTotalTimeInForeground())+&quot;\n&quot;);
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
}
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fvv9r2tdo9j308r0fkabf.jpg" alt="" loading="lazy"></figure>
</li>
</ol>
<h3 id="é™é»˜åå°æ‹æ‘„">é™é»˜åå°æ‹æ‘„</h3>
<h5 id="é™é»˜æ‹æ‘„çš„ç®€å•æ€è·¯">é™é»˜æ‹æ‘„çš„ç®€å•æ€è·¯</h5>
<ul>
<li>
<p>å°†SurfaceViewæˆ–TextureViewè¿™ä¸€é‡‡é›†å‘ˆç°çš„layoutå‚æ•°è®¾ä¸ºæœ€å°ã€‚ï¼ˆä¸èƒ½è®¾ç½®visibilityï¼šgone ä¸ä¼šé‡‡é›†åˆ°å›¾åƒï¼‰ï¼Œå¯è§ç°åœ¨é‡‡é›†æ—¶æ²¡æœ‰é‡‡é›†é¢„è§ˆï¼Œä½†é‡‡é›†åˆ°çš„bitmapå¯ä»¥æˆåŠŸè®¾ç½®ã€‚</p>
<figure data-type="image" tabindex="3"><img src="https://thumbs.gfycat.com/DenseFailingGroundhog-size_restricted.gif" alt="" loading="lazy"></figure>
</li>
<li>
<p>å†å°†SurfaceViewæ‰€åœ¨çš„Activityä¸»é¢˜é€æ˜åŒ–</p>
<p>å¯è§æ­¤æ—¶çš„é‡‡é›†æ•ˆæœä»UIä¸Šçœ‹é™é»˜è¿›è¡Œã€‚â€æ‹æ‘„â€œæŒ‰é”®åªæ˜¯æ–¹ä¾¿å±•ç¤ºæ•ˆæœï¼Œå¦‚æœä½¿ç”¨Serviceå»æ‰ç”¨åˆ™</p>
<p>çœŸæ­£å®ç°äº†åå°é™é»˜é‡‡é›†çš„æ•ˆæœï¼Œè‡³äºé‡‡é›†åˆ°bitmapå¯ä»¥å‚¨å­˜ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ä¸‰æ–¹sdkåšä¸€äº›å›¾åƒåˆ†æã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://thumbs.gfycat.com/SpryBeautifulChafer-size_restricted.gif" alt="" loading="lazy"></figure>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¼€å‘ä¸€ä¸ªIntelliJ IDEAæ’ä»¶]]></title>
        <id>https://Joshua-Chang.github.io/post/å¼€å‘ä¸€ä¸ªIntelliJ-IDEAæ’ä»¶/</id>
        <link href="https://Joshua-Chang.github.io/post/å¼€å‘ä¸€ä¸ªIntelliJ-IDEAæ’ä»¶/">
        </link>
        <updated>2017-12-26T16:03:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="çµæ„Ÿ">çµæ„Ÿ</h3>
<p>IDEAå’ŒASä¸­çš„å¤§å°å†™åˆ‡æ¢å¿«æ·é”®ï¼Œä¸€ç›´æ˜¯æ¯”è¾ƒè‰¯å¿ƒçš„ã€‚</p>
<p>åœ¨å£°æ˜ä¸€äº›å¸¸é‡æ—¶æå…¶çœäº‹ï¼Œä½†å¸¸é‡ç”±å¤šä¸ªå•è¯ç»„æˆæ—¶ï¼Œè¿˜è¦æ‰‹åŠ¨çš„åŠ ä¸Šä¸‹åˆ’çº¿åˆåŠå…¶éº»çƒ¦ã€‚</p>
<h3 id="æ€è·¯">æ€è·¯</h3>
<p>å¼€å‘ä¸€ä¸ªæ’ä»¶ï¼ŒæŠŠç¬¦åˆé©¼å³°å‘½åçš„å¤šå•è¯ç»„æˆåå­—ï¼Œåˆ†åˆ«åŠ ä¸Šä¸‹åˆ’çº¿ã€‚åä¹‹ï¼ŒæŠŠç”±ä¸‹åˆ’çº¿æ‹¼æˆçš„åå­—å˜æˆé©¼å³°<!--more--></p>
<p>å‘½åã€‚</p>
<h3 id="eg">e.g.</h3>
<ul>
<li>
<p>light_dialog_type --&gt; lightDialogType</p>
</li>
<li>
<p>anApplePie --&gt; an_apple_pie</p>
</li>
<li>
<p>homeActivityTimer --&gt;home_activity_timer --&gt; HOME_ACTIVITY_TIMER</p>
</li>
</ul>
<h3 id="å®ç°">å®ç°</h3>
<ol>
<li>æ–°å»ºä¸€ä¸ªIntelliJ Platform Pluginé¡¹ç›®ï¼Œåˆ›å»ºç›¸åº”çš„actionå¤å†™actionPerformed()</li>
<li>å¾—åˆ°AS/IDEAé€‰ä¸­çš„å¸¸é‡å</li>
</ol>
<pre><code class="language-java">       //è·å–Editorå’ŒProjectå¯¹è±¡
        Editor editor = e.getData(PlatformDataKeys.EDITOR);
        Project project = e.getData(PlatformDataKeys.PROJECT);
        if (editor == null || project == null)
            return;

        //è·å–SelectionModelå’ŒDocumentå¯¹è±¡
        SelectionModel selectionModel = editor.getSelectionModel();
        Document document = editor.getDocument();

        selectionModel.selectWordAtCaret(false);
        //æ‹¿åˆ°é€‰ä¸­éƒ¨åˆ†å­—ç¬¦ä¸²
        String selectedText = selectionModel.getSelectedText();

        //å¾—åˆ°é€‰ä¸­å­—ç¬¦ä¸²çš„èµ·å§‹å’Œç»“æŸä½ç½®
        int startOffset = selectionModel.getSelectionStart();
        int endOffset = selectionModel.getSelectionEnd();
</code></pre>
<ol start="3">
<li>æ–°çº¿ç¨‹ä¸­å»æ‰§è¡Œé©¼å³°å‘½åä¸ä¸‹åˆ’çº¿çš„è½¬æ¢æ“ä½œ</li>
</ol>
<pre><code class="language-java">        //å¯¹æ–‡æ¡£è¿›è¡Œæ“ä½œéƒ¨åˆ†ä»£ç ï¼Œéœ€è¦æ”¾å…¥Runnableæ¥å£ä¸­å®ç°ï¼Œç”±IDEAåœ¨å†…éƒ¨å°†å…¶é€šè¿‡ä¸€ä¸ªæ–°çº¿ç¨‹æ‰§è¡Œ
        Runnable runnable = new Runnable() {
            @Override
            public void run() {
                if (isLine(selectedText)) {
                    document.replaceString(startOffset, endOffset, lineToHump(selectedText));
                }else {
                    String temp=null;
                    if (selectedText.charAt(0) == 'm' &amp;&amp; selectedText.charAt(1) &lt;= 'Z' &amp;&amp; selectedText.charAt(1) &gt;= 'A') {//æƒ…å†µä¸€ï¼šæŠŠmActivityInstanceè¿™ç§å˜ä¸ºActivityInstance
                        temp = selectedText.substring(1);
                    }
                    String result = temp != null ? temp : selectedText;
                    result=humpToLine(result);
                    if (result.charAt(0)=='_') {
                        result=result.substring(1);
                    }
                    document.replaceString(startOffset, endOffset, result);
                }
            }
        };
</code></pre>
<ol start="4">
<li>åŠ å…¥ä»»åŠ¡ï¼Œç”±IDEAè°ƒåº¦æ‰§è¡Œè¿™ä¸ªä»»åŠ¡</li>
</ol>
<pre><code class="language-java">WriteCommandAction.runWriteCommandAction(project, runnable);
</code></pre>
<ol start="5">
<li>å…¶ä»–ï¼šè½¬æ¢æ–¹æ³•éƒ½æ˜¯äº›å¸¸ç”¨ç®—æ³•ä¸åšèµ˜è¿°ï¼›Actionçš„updateæ–¹æ³•çœ‹éœ€æ±‚æƒ…å†µç¼–å†™ã€‚</li>
</ol>
<h3 id="å®Œå·¥">å®Œå·¥</h3>
<p>å‘å¸ƒåœ¨JetBrainsç»™æææ„è§ï¼š<a href="https://plugins.jetbrains.com/plugin/11121-underline-camel-toggle-case">Underline Camel Toggle Case</a> æˆ–åœ¨AS/IDEAçš„pluginä¸­æœç´¢</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Viewæ»‘åŠ¨çš„å‡ ç§æ–¹å¼]]></title>
        <id>https://Joshua-Chang.github.io/post/Viewæ»‘åŠ¨çš„å‡ ç§æ–¹å¼/</id>
        <link href="https://Joshua-Chang.github.io/post/Viewæ»‘åŠ¨çš„å‡ ç§æ–¹å¼/">
        </link>
        <updated>2017-09-28T06:27:58.000Z</updated>
        <summary type="html"><![CDATA[<h3 id="viewçš„æ»‘åŠ¨">Viewçš„æ»‘åŠ¨</h3>
<p>å®ç°Viewæ»‘åŠ¨å¤§æ¦‚æœ‰ï¼šlayout()ã€offsetLeftAndRight()ï¼offsetTopAndBottom()ã€LayoutParamsã€åŠ¨ç”»ã€scollToä¸scollByå’ŒScrollerç­‰å‡ ç§æ–¹æ³•ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<h3 id="viewçš„æ»‘åŠ¨">Viewçš„æ»‘åŠ¨</h3>
<p>å®ç°Viewæ»‘åŠ¨å¤§æ¦‚æœ‰ï¼šlayout()ã€offsetLeftAndRight()ï¼offsetTopAndBottom()ã€LayoutParamsã€åŠ¨ç”»ã€scollToä¸scollByå’ŒScrollerç­‰å‡ ç§æ–¹æ³•ã€‚</p>
<!--more-->
<h3 id="layout">layout()</h3>
<pre><code class="language-java">layout(getLeft()+offsetX, getTop()+offsetY,getRight()+offsetX , getBottom()+offsetY);
</code></pre>
<h3 id="offset">offset</h3>
<pre><code class="language-java">offsetLeftAndRight(offsetX);
offsetTopAndBottom(offsetY);
</code></pre>
<h3 id="layoutparams">LayoutParams</h3>
<pre><code class="language-java">ViewGroup.MarginLayoutParams layoutParams = (ViewGroup.MarginLayoutParams) getLayoutParams();
layoutParams.leftMargin = getLeft() + offsetX;
layoutParams.topMargin = getTop() + offsetY;
setLayoutParams(layoutParams);
</code></pre>
<h3 id="scollby">scollBy</h3>
<p>åå‘ç§»åŠ¨çˆ¶å¸ƒå±€ç”»å¸ƒ</p>
<pre><code class="language-java">((View)getParent()).scrollBy(-offsetX,-offsetY);
</code></pre>
<h3 id="scroller">Scroller</h3>
<ul>
<li>åˆå§‹åŒ–Scroller</li>
</ul>
<pre><code class="language-java">public CustomView(Context context, AttributeSet attrs) {
      super(context, attrs);
      mScroller = new Scroller(context);
  }
</code></pre>
<ul>
<li>
<p>å¤å†™computeScroll()  åœ¨ç»˜åˆ¶Viewçš„æ—¶å€™åœ¨draw()ä¸­è°ƒç”¨è¯¥æ–¹æ³•</p>
<p>è°ƒç”¨çˆ¶ç±»çš„scrollTo()æ–¹æ³•å¹¶é€šè¿‡Scrolleræ¥ä¸æ–­è·å–å½“å‰çš„æ»šåŠ¨å€¼ï¼Œå¹¶è°ƒç”¨invalidate()ä¸æ–­é‡ç»˜ï¼Œé‡ç»˜å°±ä¼šè°ƒç”¨computeScroll()æ–¹æ³•ï¼Œè¿è´¯æˆç§»åŠ¨</p>
</li>
</ul>
<pre><code class="language-java">@Override
public void computeScroll() {
    super.computeScroll();
    if(mScroller.computeScrollOffset()){
        ((View) getParent()).scrollTo(mScroller.getCurrX(),mScroller.getCurrY());
         //é€šè¿‡ä¸æ–­çš„é‡ç»˜ä¸æ–­çš„è°ƒç”¨computeScrollæ–¹æ³•
         invalidate();
    }  
}
</code></pre>
<ul>
<li>startScroll()</li>
</ul>
<pre><code class="language-java">public void smoothScrollTo(int destX,int destY){
      int scrollX=getScrollX();
      int delta=destX-scrollX;
      //1000ç§’å†…æ»‘å‘destX
      mScroller.startScroll(scrollX,0,delta,0,2000);
      invalidate();
  }
</code></pre>
<ul>
<li>å¤–éƒ¨è°ƒç”¨</li>
</ul>
<pre><code class="language-java">mCustomView.smoothScrollTo(-400,0);
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[TabLayout indicatorå®½åº¦å·¥å…·ç±»]]></title>
        <id>https://Joshua-Chang.github.io/post/TabLayout-indicatorå®½åº¦å·¥å…·ç±»/</id>
        <link href="https://Joshua-Chang.github.io/post/TabLayout-indicatorå®½åº¦å·¥å…·ç±»/">
        </link>
        <updated>2017-09-22T13:35:36.000Z</updated>
        <summary type="html"><![CDATA[<h4 id="å®½åº¦å·¥å…·ç±»">å®½åº¦å·¥å…·ç±»</h4>
<p>ä¸€åŠ³æ°¸é€¸ä¹‹æ³•</p>
]]></summary>
        <content type="html"><![CDATA[<h4 id="å®½åº¦å·¥å…·ç±»">å®½åº¦å·¥å…·ç±»</h4>
<p>ä¸€åŠ³æ°¸é€¸ä¹‹æ³•</p>
<!--more-->
<pre><code class="language-java">public void reflex(final TabLayout tabLayout){
    //äº†è§£æºç å¾—çŸ¥ çº¿çš„å®½åº¦æ˜¯æ ¹æ® tabViewçš„å®½åº¦æ¥è®¾ç½®çš„
    tabLayout.post(new Runnable() {
        @Override
        public void run() {
            try {
                //æ‹¿åˆ°tabLayoutçš„mTabStripå±æ€§
                LinearLayout mTabStrip = (LinearLayout) tabLayout.getChildAt(0);

                int dp10 = dp2px(tabLayout.getContext(), 10);

                for (int i = 0; i &lt; mTabStrip.getChildCount(); i++) {
                    View tabView = mTabStrip.getChildAt(i);

                    //æ‹¿åˆ°tabViewçš„mTextViewå±æ€§  tabçš„å­—æ•°ä¸å›ºå®šä¸€å®šç”¨åå°„å–mTextView
                    Field mTextViewField = tabView.getClass().getDeclaredField(&quot;mTextView&quot;);
                    mTextViewField.setAccessible(true);

                    TextView mTextView = (TextView) mTextViewField.get(tabView);

                    tabView.setPadding(0, 0, 0, 0);

                    //å› ä¸ºæˆ‘æƒ³è¦çš„æ•ˆæœæ˜¯   å­—å¤šå®½çº¿å°±å¤šå®½ï¼Œæ‰€ä»¥æµ‹é‡mTextViewçš„å®½åº¦
                    int width = 0;
                    width = mTextView.getWidth();
                    if (width == 0) {
                        mTextView.measure(0, 0);
                        width = mTextView.getMeasuredWidth();
                    }

                    //è®¾ç½®tabå·¦å³é—´è·ä¸º10dp  æ³¨æ„è¿™é‡Œä¸èƒ½ä½¿ç”¨Padding å› ä¸ºæºç ä¸­çº¿çš„å®½åº¦æ˜¯æ ¹æ® tabViewçš„å®½åº¦æ¥è®¾ç½®çš„
                    LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) tabView.getLayoutParams();
                    params.width = width ;
                    params.leftMargin = dp10;
                    params.rightMargin = dp10;
                    tabView.setLayoutParams(params);

                    tabView.invalidate();
                }

            } catch (NoSuchFieldException e) {
                e.printStackTrace();
            } catch (IllegalAccessException e) {
                e.printStackTrace();
            }
        }
    });

}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[IPCæœºåˆ¶ä¹‹Messenger]]></title>
        <id>https://Joshua-Chang.github.io/post/IPCæœºåˆ¶ä¹‹Messenger/</id>
        <link href="https://Joshua-Chang.github.io/post/IPCæœºåˆ¶ä¹‹Messenger/">
        </link>
        <updated>2017-06-02T02:42:31.000Z</updated>
        <summary type="html"><![CDATA[<h4 id="æ¦‚å¿µ">æ¦‚å¿µ</h4>
<p>Messengeræ˜¯ä¸€ç§è½»é‡çº§çš„IPCæ–¹æ¡ˆï¼Œå®ƒçš„åº•å±‚å®ç°æ˜¯AIDLï¼Œé€šè¿‡Messengerå¯ä»¥åœ¨ä¸åŒè¿›ç¨‹ä¸­ä¼ é€’Messageå¯¹è±¡ï¼Œåœ¨Messageä¸­æ”¾å…¥æˆ‘ä»¬éœ€è¦ä¼ é€’çš„æ•°æ®å°±å¯ä»¥è½»æ¾å®ç°æ•°æ®åœ¨è¿›ç¨‹é—´ä¼ é€’äº†ã€‚</p>
<p>åœ¨Messengerä¸­è¿›è¡Œæ•°æ®ä¼ é€’å¿…é¡»å°†æ•°æ®æ”¾å…¥Messageä¸­ï¼Œè€ŒMessengerå’ŒMessageéƒ½å®ç°äº†Parcelableæ¥å£ï¼Œå› æ­¤å¯ä»¥è·¨è¿›ç¨‹ä¼ è¾“ã€‚</p>
<p>Messengerçš„ä½¿ç”¨å¾ˆç®€å•ï¼Œç”±äºå®ƒä¸€æ¬¡å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œå› æ­¤åœ¨æœåŠ¡ç«¯ä¸ç”¨è€ƒè™‘çº¿ç¨‹åŒæ­¥çš„é—®é¢˜ã€‚Messengerå®ç°è¿›ç¨‹é—´é€šä¿¡å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼Œåˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<h4 id="æ¦‚å¿µ">æ¦‚å¿µ</h4>
<p>Messengeræ˜¯ä¸€ç§è½»é‡çº§çš„IPCæ–¹æ¡ˆï¼Œå®ƒçš„åº•å±‚å®ç°æ˜¯AIDLï¼Œé€šè¿‡Messengerå¯ä»¥åœ¨ä¸åŒè¿›ç¨‹ä¸­ä¼ é€’Messageå¯¹è±¡ï¼Œåœ¨Messageä¸­æ”¾å…¥æˆ‘ä»¬éœ€è¦ä¼ é€’çš„æ•°æ®å°±å¯ä»¥è½»æ¾å®ç°æ•°æ®åœ¨è¿›ç¨‹é—´ä¼ é€’äº†ã€‚</p>
<p>åœ¨Messengerä¸­è¿›è¡Œæ•°æ®ä¼ é€’å¿…é¡»å°†æ•°æ®æ”¾å…¥Messageä¸­ï¼Œè€ŒMessengerå’ŒMessageéƒ½å®ç°äº†Parcelableæ¥å£ï¼Œå› æ­¤å¯ä»¥è·¨è¿›ç¨‹ä¼ è¾“ã€‚</p>
<p>Messengerçš„ä½¿ç”¨å¾ˆç®€å•ï¼Œç”±äºå®ƒä¸€æ¬¡å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œå› æ­¤åœ¨æœåŠ¡ç«¯ä¸ç”¨è€ƒè™‘çº¿ç¨‹åŒæ­¥çš„é—®é¢˜ã€‚Messengerå®ç°è¿›ç¨‹é—´é€šä¿¡å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼Œåˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚</p>
<!--more-->
<h4 id="æœåŠ¡ç«¯è¿›ç¨‹">æœåŠ¡ç«¯è¿›ç¨‹</h4>
<p>æœåŠ¡ç«¯æ–°å»ºä¸€ä¸ªServiceæ¥å¤„ç†å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ªHandlerå¹¶é€šè¿‡å®ƒæ¥åˆ›å»ºä¸€ä¸ªMessengerå¯¹è±¡ï¼Œç„¶ååœ¨Serviceçš„onBindä¸­è¿”å›è¿™ä¸ªMessengerå¯¹è±¡åº•å±‚çš„Binderå³å¯ã€‚</p>
<p>å¦‚æœéœ€è¦å®¢æœç«¯èƒ½å¤Ÿå›åº”å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆå’ŒæœåŠ¡ç«¯ä¸€æ ·ï¼Œåœ¨å®¢æˆ·ç«¯è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„Messenger,å¹¶æŠŠè¿™ä¸ªMessengerå¯¹è±¡é€šè¿‡Messageçš„replyToå‚æ•°ä¼ é€’ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯é€šè¿‡è¿™ä¸ªreplyToå‚æ•°å°±å¯ä»¥å›åº”å®¢æˆ·ç«¯ã€‚</p>
<pre><code class="language-java">public class MyService extends Service {
    public static final int MSG_FROM_SERVICE=2;
    public MyService() {}
    public static class MessagerHandler extends Handler{
        @Override
        public void handleMessage(Message msg) {
            if (msg.what==MainActivity.MSG_FROM_CLIENT){
                Log.e(&quot;xxx&quot;,&quot;msg from client: &quot;+msg.getData().getString(&quot;msg&quot;));

                Messenger mReplyTo = msg.replyTo;
                Message mMessage=Message.obtain(null,MSG_FROM_SERVICE);
                Bundle mBundle=new Bundle();
                mBundle.putString(&quot;reply&quot;,&quot;Hi,service received succeed&quot;);
                mMessage.setData(mBundle);
                try {
                    mReplyTo.send(mMessage);
                } catch (RemoteException e) {
                    e.printStackTrace();
                }
            }
        }
    }
  //1.åˆ›å»ºMessengerï¼ˆéœ€è¦handlerï¼‰å¯¹è±¡
    private Messenger mMessenger=new Messenger(new MessagerHandler());
    @Override
    public IBinder onBind(Intent intent) {
      //2.åœ¨Serviceçš„onBindä¸­è¿”å›è¿™ä¸ªMessengerå¯¹è±¡åº•å±‚çš„Binder ä¾›å®¢æˆ·ç«¯ä½¿ç”¨
        return mMessenger.getBinder();
    }
}
</code></pre>
<h4 id="å®¢æˆ·ç«¯è¿›ç¨‹">å®¢æˆ·ç«¯è¿›ç¨‹</h4>
<p>å®¢æˆ·ç«¯è¿›ç¨‹ä¸­é¦–å…ˆè¦ç»‘å®šæœåŠ¡ç«¯çš„Serviceï¼Œç»‘å®šæˆåŠŸåç”¨æœåŠ¡ç«¯è¿”å›çš„IBinderå¯¹è±¡åˆ›å»ºä¸€ä¸ªMessengerï¼Œé€šè¿‡è¿™ä¸ªMessengerå°±å¯ä»¥å‘æœåŠ¡ç«¯å‘é€ç±»å‹ä¸ºMessageçš„æ¶ˆæ¯äº†ï¼Œmessageå†…å¯ä»¥å­˜å…¥Bundleã€‚</p>
<pre><code class="language-java">public class MainActivity extends AppCompatActivity {
    public static final int MSG_FROM_CLIENT=1;

    private ServiceConnection mServiceConnection=new ServiceConnection() {
        @Override
        public void onServiceConnected(ComponentName name, IBinder service) {
          //2.ç»‘å®šæˆåŠŸå,æ ¹æ®ä¸Šæ–‡è¿”å›çš„IBinderå¯¹è±¡åˆ›å»ºä¸€ä¸ªMessenger
            Messenger mMessenger=new Messenger(service);
            Message mMessage = Message.obtain(null, MSG_FROM_CLIENT);
            Bundle mBundle=new Bundle();
            mBundle.putString(&quot;msg&quot;,&quot;hello,this msg from client&quot;);
            mMessage.setData(mBundle);

            mMessage.replyTo=mReplyMessenger;
            try {
                mMessenger.send(mMessage);
            } catch (RemoteException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void onServiceDisconnected(ComponentName name) {

        }
    };
    private static class ReceiveHandler extends Handler{
        @Override
        public void handleMessage(Message msg) {
            if (msg.what==MyService.MSG_FROM_SERVICE){
                Log.e(&quot;xxx&quot;,&quot;msg from service: &quot;+msg.getData().getString(&quot;reply&quot;));
            }
        }
    }
    private Messenger mReplyMessenger=new Messenger(new ReceiveHandler());

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
      //1.ç»‘å®šæœåŠ¡ç«¯çš„Service
        Intent mIntent=new Intent(this,MyService.class);
        bindService(mIntent,mServiceConnection,BIND_AUTO_CREATE);
    }

    @Override
    protected void onDestroy() {
        unbindService(mServiceConnection);
        super.onDestroy();
    }
}
</code></pre>
<h4 id="extra">Extra</h4>
<p>æ³¨å†Œserviceæ—¶ä¸ºæ–°çš„å…¨å±€è¿›ç¨‹</p>
<pre><code class="language-xml">&lt;service
    android:name=&quot;.MyService&quot;
    android:process=&quot;com.coolapk.developer_verify_package&quot;&gt;
&lt;/service&gt;
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[dagger2çš„Qualifierä¸Scope]]></title>
        <id>https://Joshua-Chang.github.io/post/dagger2çš„Qualifierä¸Scope/</id>
        <link href="https://Joshua-Chang.github.io/post/dagger2çš„Qualifierä¸Scope/">
        </link>
        <updated>2017-05-21T11:18:57.000Z</updated>
        <summary type="html"><![CDATA[<h4 id="qualifierå³named">Qualifierå³Named</h4>
<p>å½“moduleçš„@Providesæä¾›ç›¸åŒå˜é‡çš„ä¸åŒå±æ€§æ—¶ï¼šç”¨äºåŒºåˆ†æŠŠå“ªä¸€ä¸ªåˆå§‹åŒ–</p>
<h5 id="module">Module</h5>
<pre><code class="language-java">@Module
public class ClothModule {
    @Blue
    @Provides
    public Cloth getBluecloth(){
        Cloth mCloth=new Cloth();
        mCloth.setColor(&quot;è“&quot;);
        return mCloth;
    }
    @Named(&quot;Red&quot;)
    @Provides
    public Cloth getRedcloth(){
        Cloth mCloth=new Cloth();
        mCloth.setColor(&quot;çº¢&quot;);
        return mCloth;
    }
}
</code></pre>
]]></summary>
        <content type="html"><![CDATA[<h4 id="qualifierå³named">Qualifierå³Named</h4>
<p>å½“moduleçš„@Providesæä¾›ç›¸åŒå˜é‡çš„ä¸åŒå±æ€§æ—¶ï¼šç”¨äºåŒºåˆ†æŠŠå“ªä¸€ä¸ªåˆå§‹åŒ–</p>
<h5 id="module">Module</h5>
<pre><code class="language-java">@Module
public class ClothModule {
    @Blue
    @Provides
    public Cloth getBluecloth(){
        Cloth mCloth=new Cloth();
        mCloth.setColor(&quot;è“&quot;);
        return mCloth;
    }
    @Named(&quot;Red&quot;)
    @Provides
    public Cloth getRedcloth(){
        Cloth mCloth=new Cloth();
        mCloth.setColor(&quot;çº¢&quot;);
        return mCloth;
    }
}
</code></pre>
<!--more-->
<h5 id="component">Component</h5>
<pre><code class="language-java">@Component(modules=ClothModule.class)
public interface ClothCompetent {
    void inject(MainActivity mainActivity);
}
</code></pre>
<h5 id="activity">Activity</h5>
<pre><code class="language-java">public class MainActivity extends AppCompatActivity {
    TextView mTextView;
    @Named(&quot;Red&quot;)
    @Inject
    Cloth mClothRed;
    @Blue
    @Inject
    Cloth mClothBlue;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        mTextView= (TextView) findViewById(R.id.tv1);
        ClothCompetent mClothCompetent=DaggerClothCompetent.builder().clothModule(new ClothModule()).build();
        mClothCompetent.inject(this);
        mTextView.setText(mClothRed+&quot;\n&quot;+mClothBlue);
    }
}
</code></pre>
<h5 id="qualifier">Qualifier</h5>
<p>è‡ªå®šä¹‰çš„Qualifierä¸å®˜æ–¹çš„NamedåŸç†ä¸€æ ·</p>
<pre><code class="language-java">@Qualifier
@Retention(RetentionPolicy.RUNTIME)
public @interface Blue {
}
</code></pre>
<p>å®˜æ–¹çš„Named</p>
<pre><code class="language-java">@Qualifier
@Documented
@Retention(RUNTIME)
public @interface Named {

    /** The name. */
    String value() default &quot;&quot;;
}
</code></pre>
<h4 id="scopeå³singleton">Scopeå³Singleton</h4>
<p>ä»¥Componentä¸ºä¾æ®ï¼Œåœ¨æŒ‡å®šèŒƒå›´å†…çš„å•ä¾‹</p>
<h5 id="module-2">Module</h5>
<ol>
<li>åœ¨@Providesä¸ºå¤–ç•Œæä¾›Jacketæ—¶ï¼Œå‚æ•°ä¸­ç”¨åˆ°äº†Clothï¼Œå¿…é¡»åœ¨Moduleä¸­@Providesä¸ºJacketæä¾›Cloth</li>
<li>è‡ªå®šä¹‰çš„Qualifierå’ŒNamedä¹Ÿå¯ä»¥åœ¨å‚æ•°ä¸­ä½¿ç”¨</li>
</ol>
<pre><code class="language-java">@Module
public class JacketModule {
    @Provides
    public Jacket getJacket(@Named(&quot;Red&quot;) Cloth cloth){
        return new Jacket(cloth);
    }
    @Singleton
    @Named(&quot;Red&quot;)
    @Provides
    public Cloth getRedCloth(){
       Cloth mCloth=new Cloth();
        mCloth.setColor(&quot;çº¢&quot;);
        return mCloth;
    }
    @Blue
    @Provides
    public Cloth getBluecloth(){
        Cloth mCloth=new Cloth();
        mCloth.setColor(&quot;è“&quot;);
        return mCloth;
    }
}
</code></pre>
<h5 id="component-2">Component</h5>
<p>åœ¨ç”¨åˆ°çš„Clothå’ŒComponentä¸ŠåŒæ—¶æ·»åŠ @Singletonï¼Œæ­¤æ—¶Clothä¸ºå•ä¾‹</p>
<pre><code class="language-java">@Singleton
@Component(modules = JacketModule.class)
public interface JacketComponent {
    void inject(MainActivity mainActivity);
}
</code></pre>
<h5 id="activity-2">Activity</h5>
<p>æ­¤æ—¶çš„Clothå’ŒJacketRed.getCloth()ä¸ºåŒä¸€ä¸ª</p>
<pre><code class="language-java">public class MainActivity extends AppCompatActivity {
    TextView mTextView;
    @Named(&quot;Red&quot;)
    @Inject
    Cloth mClothRed;
    @Inject
    Jacket mJacketRed;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        mTextView= (TextView) findViewById(R.id.tv1);
        JacketComponent mJacketComponent = DaggerJacketComponent.builder().jacketModule(new JacketModule()).build();
        mJacketComponent.inject(this);
        mTextView.setText((mJacketRed.getCloth() == mClothRed) + &quot;&quot;);
    }
}
</code></pre>
<h5 id="scope">Scope</h5>
<p>è‡ªå®šä¹‰çš„Scopeä¸å®˜æ–¹çš„SingletonåŸç†ä¸€æ ·ï¼Œæ›¿æ¢Singletonä¸ºJacketSingletonä»è¿”å›true</p>
<p>è‡ªå®šä¹‰çš„JacketSingletonï¼šåœ¨JacketSingletonä½œç”¨åŸŸå†…å•ä¾‹</p>
<pre><code class="language-java">@Scope
@Retention(RetentionPolicy.RUNTIME)
public @interface JacketSingleton {
}
</code></pre>
<p>å®˜æ–¹çš„Singleton</p>
<pre><code class="language-java">@Scope
@Documented
@Retention(RUNTIME)
public @interface Singleton {}
</code></pre>
<h4 id="dependencies">dependencies</h4>
<p>å®ä¾‹ï¼šåˆ†åˆ«åˆ›å»ºä¸¤ä¸ªActivityï¼Œè·³è½¬åçš„å®ä¾‹ä¸ºåŒä¸€ä¸ªï¼ˆå·¥å…·ç±»å¤šæ­¤ç”¨æ³•åœ¨appå±‚å•ä¾‹ï¼‰</p>
<h5 id="åˆ†åˆ«åˆ›å»ºä¸¤ä¸ªmodule">åˆ†åˆ«åˆ›å»ºä¸¤ä¸ªModule</h5>
<p>JacketModuleä¸JacketModule2</p>
<h5 id="åˆ›å»ºcomponent">åˆ›å»ºComponent</h5>
<h6 id="æ–¹æ³•ä¸€dependencies">æ–¹æ³•ä¸€ï¼šdependencies</h6>
<pre><code class="language-java">@JacketSingleton
@Component(modules = JacketModule.class,dependencies = BaseComponent.class)
public interface JacketComponent {
    void inject(MainActivity mainActivity);
}
</code></pre>
<h6 id="æ–¹æ³•äºŒsubcomponent">æ–¹æ³•äºŒï¼šSubcomponent</h6>
<pre><code class="language-java">@JacketSingleton
@Subcomponent(modules = JacketModule2.class)
public interface JacketComponent2 {
    void inject(MainActivity2 mainActivity);
}
</code></pre>
<h5 id="åˆ›å»ºbasemodule">åˆ›å»ºBaseModule</h5>
<pre><code class="language-java">@Module
public class BaseModule {
    @Singleton
    @Provides
    public Jacket getJacket(@Named(&quot;Red&quot;) Cloth cloth){
        return new Jacket(cloth);
    }
    @Singleton
    @Provides
    @Named(&quot;Red&quot;)
    public Cloth getRedCloth(){
        Cloth mCloth=new Cloth();
        mCloth.setColor(&quot;çº¢&quot;);
        return mCloth;
    }
}
</code></pre>
<h5 id="åˆ›å»ºbasecomponent">åˆ›å»ºBaseComponent</h5>
<pre><code class="language-java">@Singleton
@Component(modules = BaseModule.class)
public interface BaseComponent {
    Jacket getJacket();//dependenciesä¾èµ–å£°æ˜çš„æ–¹å¼
    JacketComponent2 getJacketComponent2(JacketModule2 jacketModule2);//@Subcomponentä½¿ç”¨çš„å£°æ˜æ–¹å¼,å£°æ˜ä¸€ä¸ªè¿”å›å€¼ä¸ºå­ç»„ä»¶çš„æ–¹æ³•,å­ç»„ä»¶éœ€è¦ä»€ä¹ˆModule,å°±åœ¨æ–¹æ³•å‚æ•°ä¸­æ·»åŠ ä»€ä¹ˆ
}
</code></pre>
<h5 id="åœ¨appä¸­åˆå§‹åŒ–basecomponent">åœ¨appä¸­åˆå§‹åŒ–BaseComponent</h5>
<pre><code class="language-java">public class App extends Application {
        private BaseComponent baseComponent;
        @Override
        public void onCreate() {
            super.onCreate();
            baseComponent = DaggerBaseComponent.builder().baseModule(new BaseModule()).build();
        }

        public BaseComponent getBaseComponent() {
            return baseComponent;
        }
}
</code></pre>
<h5 id="åœ¨ä¸¤ä¸ªactivityä¸­ä½¿ç”¨">åœ¨ä¸¤ä¸ªActivityä¸­ä½¿ç”¨</h5>
<pre><code class="language-java">public class MainActivity extends AppCompatActivity {
    TextView mTextView;
    @Named(&quot;Red&quot;)
    @Inject
    Cloth mClothRed;
    @Inject
    Jacket mJacketRed;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        mTextView= (TextView) findViewById(R.id.tv1);
        JacketComponent mJacketComponent = DaggerJacketComponent.builder().baseComponent(((App) getApplication()).getBaseComponent()).jacketModule(new JacketModule()).build();
        mJacketComponent.inject(this);
        mTextView.setText(mJacketRed.hashCode()+&quot;&quot;);
    }
    public void go(View view) {
        Intent intent = new Intent(this,MainActivity2.class);
        intent.putExtra(&quot;xx&quot;,mJacketRed.hashCode()+&quot;&quot;);
        startActivity(intent);
    }
}
</code></pre>
<pre><code class="language-java">public class MainActivity2 extends AppCompatActivity {
    TextView mTextView;
    @Named(&quot;Red&quot;)
    @Inject
    Cloth mClothRed;
    @Inject
    Jacket mJacketRed;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main2);
        mTextView= (TextView) findViewById(R.id.tv2);
        App application = (App) getApplication();
        application.getBaseComponent().getJacketComponent2(new JacketModule2()).inject(this);
        String mString = (String) getIntent().getExtras().get(&quot;xx&quot;);
        mTextView.setText(mString+&quot;\n&quot;+mJacketRed.hashCode()+&quot;&quot;);
    }
}
</code></pre>
<h5 id="ç»“è®º">ç»“è®º</h5>
<p>åˆ†åˆ«åœ¨ä¸¤ä¸ªActivityä¸­åˆå§‹åŒ–çš„Jacketå“ˆå¸Œå€¼ç›¸åŒï¼Œä¸ºåŒä¸€ä¸ªå˜é‡ï¼Œappå±‚å•ä¾‹ã€‚</p>
<h4 id="lazyä¸provider">Lazyä¸Provider</h4>
<p>Lazyç”¨äºå»¶è¿ŸåŠ è½½,æ‰€è°“çš„æ‡’åŠ è½½å°±æ˜¯å½“ä½ éœ€è¦ç”¨åˆ°è¯¥ä¾èµ–å¯¹è±¡æ—¶,Dagger2æ‰å¸®ä½ å»è·å–ä¸€ä¸ª;Provideç”¨äºå¼ºåˆ¶é‡æ–°åŠ è½½,ä¹Ÿå°±æ˜¯æ¯ä¸€è¦ç”¨åˆ°ä¾èµ–å¯¹è±¡æ—¶,Dagger2éƒ½ä¼šå¸®ä½ ä¾èµ–æ³¨å…¥ä¸€æ¬¡</p>
<pre><code class="language-java">    @Inject //Lazyå£°æ˜æ–¹å¼
    Lazy&lt;Cloth&gt; redCloth;
    @Inject //Providerå£°æ˜æ–¹å¼
    Provider&lt;Shoe&gt; shoe;
</code></pre>
]]></content>
    </entry>
</feed>